<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
    <title>Testing embed</title>

    <!-- Bootstrap -->
    <link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/css/bootstrap.min.css" rel="stylesheet" data-remove="false" data-concat="false">
     <!-- <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js" data-remove="false" data-concat="false"></script>
    <link rel="stylesheet" href="https://cdn.parlameter.si/v1/parlassets/css/perfect-scrollbar.css" data-remove="false" data-concat="false">
    <script src="https://cdn.parlameter.si/v1/parlassets/js/perfect-scrollbar.js" data-remove="false" data-concat="false"></script>
    <script src="https://cdn.parlameter.si/v1/parlassets/js/perfect-scrollbar.jquery.js" data-remove="false" data-concat="false"></script> -->
    <link rel="stylesheet" href="https://cdn.parlameter.si/v1/parlassets/scss/style.css" data-remove="false" data-concat="false">

</head>

<body>
    <div class="container">

        

         <div class="row">
            <div class="col-md-12">
                <div class="parlameter-card" data-src="https://glej.parlameter.si/pg/odstopanje-od-poslanske-skupine/1/"></div>
            </div>
        </div>

		<div class="row">
            <div class="col-md-12">
                <div class="parlameter-card" data-src="https://glej.parlameter.si/p/povezave-do-govorov/82/"></div>
            </div>
        </div>


		<div class="row">
            <div class="col-md-12">
                <div class="parlameter-card" data-src="https://glej.parlameter.si/ps/vsi-govori-poslanske-skupine/3/01.01.2015"></div>
            </div>
        </div>
		
        


    </div>

    <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
    <!-- Include all compiled plugins (below), or include individual files as needed -->
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js"></script>

<script>


console.log('embed');

if (!window.parlaCardInit) {

console.log('embed1');

    window.parlaCardInit = true;


    function loadScript(url, callback) {
console.log('embed2');
        // check for duplicates
        var list = document.getElementsByTagName('script');
        var i = list.length,
            flag = false;
        while (i--) {
            if (list[i].src == url) {
                flag = true;
            }
        }
        if (!flag) {
            console.log('loading: ' + url);
            var tag = document.createElement('script');
            tag.type = "text/javascript";

            if (tag.readyState) { //IE
                tag.onreadystatechange = function() {
                    if (tag.readyState == "loaded" || tag.readyState == "complete") {
                        tag.onreadystatechange = null;
                        callback();
                    }
                };
            } else { //Others
                tag.onload = function() {
                    callback();
                };
            }

            tag.src = url;
            document.getElementsByTagName("head")[0].appendChild(tag);
        }

    }

    if (window.jQuery) {
        loadScript('https://cdn.parlameter.si/v1/parlassets/js/perfect-scrollbar.js', function() {
            loadScript('https://cdn.parlameter.si/v1/parlassets/js/perfect-scrollbar.jquery.js', function() {
                loadScript('https://d3js.org/d3.v3.min.js', function() {
                    loadScript('https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.3/js/select2.min.js', function() {
                        loadScript('https://cdn.parlameter.si/v1/parlassets/js/scriptoptimized.js', function() {
                            init();
                        });
                    });
                });
            });
        });
    } else {
        loadScript("https://code.jquery.com/jquery-1.11.3.js", function() {
            loadScript('https://cdn.parlameter.si/v1/parlassets/js/perfect-scrollbar.js', function() {
                loadScript('https://cdn.parlameter.si/v1/parlassets/js/perfect-scrollbar.jquery.js', function() {
                    loadScript('https://d3js.org/d3.v3.min.js', function() {
                        loadScript('https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.3/js/select2.min.js', function() {
                            loadScript('https://cdn.parlameter.si/v1/parlassets/js/scriptoptimized.js', function() {
                                init();
                            });
                        });
                    });
                });
            });
        });
    }

    function init() {

					   console.log('init');

        var $cards = $('.parlameter-card');

        for (var i = 0; i < $cards.length; i++) {

console.log('before' + i);
            var card = new Card($cards[i], i, $cards.length);

console.log('after' + i);

        }


    }

    var Card = function(element, index, allelements) {

        this.mUrl = $(element).attr('data-src');
        this.mElement = $(element);

        this.fetchCard(index, allelements);


		console.log('card');


    };

    Card.prototype.fetchCard = function(index, allelements) {

        var self = this;

        $.get(this.mUrl)
            .success(function(response) {

                self.mElement.append(response);

				console.log('card success' + (index+1) + ' ' + allelements);

					if((index+1) == allelements){
DNDrepeatEmbedCall();
					}



            });


    };

}


</script>
</body>

</html>
